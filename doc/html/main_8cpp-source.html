<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>RTVideoFilter: projects/RTVideoFilter/main.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>projects/RTVideoFilter/main.cpp</h1><a href="main_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;allegro.h&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;sys/times.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="VideoEncoder_8h.html">VideoEncoder.h</a>"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="VideoDecoder_8h.html">VideoDecoder.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "<a class="code" href="PipeDecoder_8h.html">PipeDecoder.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="VideoCapturer_8h.html">VideoCapturer.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="FilterFactory_8h.html">FilterFactory.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="Filters_8h.html">Filters.h</a>"</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="keyword">using namespace </span>std;
<a name="l00014"></a>00014 
<a name="l00015"></a><a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">00015</a> <span class="preprocessor">#define FILTER_BOX_WIDTH    150</span>
<a name="l00016"></a><a class="code" href="main_8cpp.html#3b322cc788cf1b95fc0c242cb102225b">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define ORIG_WIDTH          160</span>
<a name="l00017"></a><a class="code" href="main_8cpp.html#3011f7116dcb3bb5dcb483cc31c1383c">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define ORIG_HEIGHT         120</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00019"></a><a class="code" href="main_8cpp.html#418fe1f731f76cdbe573e192c72dd497">00019</a> <span class="preprocessor">#define NO_SEQUENCE         -1</span>
<a name="l00020"></a><a class="code" href="main_8cpp.html#b0fe344a06a86782503c655929714de0">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define SEQUENCE_COUNT      12</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#define DEBUG_OUT(x)    cout &lt;&lt; x;</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00025"></a><a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define DEBUG_OUT(x)</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00029"></a><a class="code" href="main_8cpp.html#ca81775eca8adbdd201c9d1169b16314">00029</a> <span class="keyword">typedef</span> vector&lt;CVideoFilter*&gt; <a class="code" href="main_8cpp.html#ca81775eca8adbdd201c9d1169b16314" title="pomocny typ - vektro filtru">FilterVector_t</a>;
<a name="l00031"></a><a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce">00031</a> <a class="code" href="main_8cpp.html#ca81775eca8adbdd201c9d1169b16314" title="pomocny typ - vektro filtru">FilterVector_t</a> <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>;
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162">00033</a> <span class="keywordtype">int</span> <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>;    
<a name="l00034"></a><a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0">00034</a> <span class="keywordtype">int</span> <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>;   
<a name="l00035"></a><a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278">00035</a> <span class="keywordtype">int</span> <a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a> = 32;       
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">// globalni promenne</span>
<a name="l00038"></a><a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d">00038</a> <span class="keywordtype">bool</span>   <a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d" title="zobrazovat nastaveni">show_options</a>;        
<a name="l00039"></a><a class="code" href="main_8cpp.html#752b7698937b6a908ce52deabebfc077">00039</a> <span class="keywordtype">bool</span>   <a class="code" href="main_8cpp.html#752b7698937b6a908ce52deabebfc077" title="ukoncit aplikaci">end_app</a>;             
<a name="l00040"></a><a class="code" href="main_8cpp.html#5bc28e363ce09640d06d11264b58a42a">00040</a> <span class="keywordtype">bool</span>   <a class="code" href="main_8cpp.html#5bc28e363ce09640d06d11264b58a42a" title="obsahuje sekvence">contain_sequences</a>;   
<a name="l00041"></a><a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e">00041</a> <span class="keywordtype">int</span>    <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>;               
<a name="l00042"></a><a class="code" href="main_8cpp.html#e21fce8f8c6b4ccc0c77c87562648830">00042</a> <span class="keywordtype">int</span>    <a class="code" href="main_8cpp.html#e21fce8f8c6b4ccc0c77c87562648830" title="y-ova pozice kurzoru">cur_y</a>;               
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// nastaveni</span>
<a name="l00045"></a><a class="code" href="structOptions__t.html">00045</a> <span class="keyword">struct </span><a class="code" href="structOptions__t.html">Options_t</a>
<a name="l00046"></a>00046 {
<a name="l00047"></a><a class="code" href="structOptions__t.html#5754365db059e54caaaea5020cc821d2">00047</a>     <span class="keywordtype">char</span>    <a class="code" href="structOptions__t.html#5754365db059e54caaaea5020cc821d2">pipeName</a>[256];
<a name="l00048"></a><a class="code" href="structOptions__t.html#3f00b76063285cd0d1bd50a86dbeb92f">00048</a>     <span class="keywordtype">char</span>    <a class="code" href="structOptions__t.html#3f00b76063285cd0d1bd50a86dbeb92f">fileName</a>[256];
<a name="l00049"></a><a class="code" href="structOptions__t.html#f2562ebcc61f9196bfe9bde09743e0a8">00049</a>     <span class="keywordtype">char</span>    <a class="code" href="structOptions__t.html#f2562ebcc61f9196bfe9bde09743e0a8">configName</a>[256];
<a name="l00050"></a><a class="code" href="structOptions__t.html#c927c84494708366ca26a7a3816c2301">00050</a>     <span class="keywordtype">char</span>    <a class="code" href="structOptions__t.html#c927c84494708366ca26a7a3816c2301">outputName</a>[256];
<a name="l00051"></a><a class="code" href="structOptions__t.html#33e331e45d37d0804408fa1c132ca88e">00051</a>     <span class="keywordtype">int</span>     <a class="code" href="structOptions__t.html#33e331e45d37d0804408fa1c132ca88e">outputWidth</a>;
<a name="l00052"></a><a class="code" href="structOptions__t.html#865ff7e96699933398dbaaa0b67de836">00052</a>     <span class="keywordtype">int</span>     <a class="code" href="structOptions__t.html#865ff7e96699933398dbaaa0b67de836">outputHeight</a>;
<a name="l00053"></a><a class="code" href="structOptions__t.html#c114dc35d6ea615cc0f06cb664fe302a">00053</a>     <span class="keywordtype">int</span>     <a class="code" href="structOptions__t.html#c114dc35d6ea615cc0f06cb664fe302a">fwNode</a>;
<a name="l00054"></a><a class="code" href="structOptions__t.html#bdb92beff90cfeeddac3feb7a1a74d64">00054</a>     <span class="keywordtype">int</span>     <a class="code" href="structOptions__t.html#bdb92beff90cfeeddac3feb7a1a74d64">width</a>;
<a name="l00055"></a><a class="code" href="structOptions__t.html#639b62946ad9df187f74c2bbaea94058">00055</a>     <span class="keywordtype">int</span>     <a class="code" href="structOptions__t.html#639b62946ad9df187f74c2bbaea94058">height</a>;
<a name="l00056"></a><a class="code" href="structOptions__t.html#15184328111fdbb45b30d42d74e21df2">00056</a>     <span class="keywordtype">bool</span>    <a class="code" href="structOptions__t.html#15184328111fdbb45b30d42d74e21df2">fullscreen</a>;
<a name="l00057"></a><a class="code" href="structOptions__t.html#aeb31edf37162045e4a769cbb75051af">00057</a>     <span class="keywordtype">bool</span>    <a class="code" href="structOptions__t.html#aeb31edf37162045e4a769cbb75051af">help</a>;
<a name="l00058"></a><a class="code" href="structOptions__t.html#c078fecdc60ecdadfe6120a72234ebf2">00058</a>     <span class="keywordtype">bool</span>    <a class="code" href="structOptions__t.html#c078fecdc60ecdadfe6120a72234ebf2">dump</a>;
<a name="l00059"></a>00059 }<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>;
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2">00061</a> <span class="keyword">enum</span> <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2">ArgType_t</a>
<a name="l00062"></a>00062 {
<a name="l00063"></a><a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">00063</a>     <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">A_NONE</a>,
<a name="l00064"></a><a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2c2958f8037785e8e7cd1d500d6bb9ed2">00064</a>     <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2c2958f8037785e8e7cd1d500d6bb9ed2">A_STRING</a>,
<a name="l00065"></a><a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">00065</a>     <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">A_INT</a>
<a name="l00066"></a>00066 };
<a name="l00067"></a>00067 
<a name="l00068"></a><a class="code" href="structArgs__t.html">00068</a> <span class="keyword">struct </span><a class="code" href="structArgs__t.html">Args_t</a>
<a name="l00069"></a>00069 {
<a name="l00070"></a><a class="code" href="structArgs__t.html#7fde81cc9f73ac6b03240ddab496a1a0">00070</a>     <span class="keywordtype">char</span>        <a class="code" href="structArgs__t.html#7fde81cc9f73ac6b03240ddab496a1a0" title="text parametru">arg_text</a>[256];  
<a name="l00071"></a><a class="code" href="structArgs__t.html#46a82d76ef0bed223bc62ee579d23739">00071</a>     <span class="keywordtype">char</span>        <a class="code" href="structArgs__t.html#46a82d76ef0bed223bc62ee579d23739" title="alternativni text">arg_alt</a>[256];   
<a name="l00072"></a><a class="code" href="structArgs__t.html#0200da8cba0bc77b9d381728721a6705">00072</a>     <span class="keywordtype">char</span>        <a class="code" href="structArgs__t.html#0200da8cba0bc77b9d381728721a6705" title="napoveda parametru">help</a>[256];      
<a name="l00073"></a><a class="code" href="structArgs__t.html#e09381aadcddaf81a9c8b51288e339c3">00073</a>     <span class="keywordtype">void</span>        *<a class="code" href="structArgs__t.html#e09381aadcddaf81a9c8b51288e339c3" title="ukazatel na hodnotu parametru">pointer</a>;       
<a name="l00074"></a><a class="code" href="structArgs__t.html#59548f3a0abd9a9150cc1269dd7619bc">00074</a>     <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2">ArgType_t</a>   <a class="code" href="structArgs__t.html#59548f3a0abd9a9150cc1269dd7619bc" title="typ parametru">type</a>;           
<a name="l00075"></a>00075 };
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="main_8cpp.html#3d55bd9b399beca55d56d719de52243f">00077</a> <span class="preprocessor">#define OPTIONS_SIZE    12</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span>
<a name="l00079"></a><a class="code" href="main_8cpp.html#840e20064cfb6eedf881b3957e81acd0">00079</a> <a class="code" href="structArgs__t.html">Args_t</a>  <a class="code" href="main_8cpp.html#840e20064cfb6eedf881b3957e81acd0">options_config</a>[] =
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081   <span class="comment">/* 1 */</span>  { <span class="stringliteral">"--pipe"</span>,      <span class="stringliteral">"-p"</span>,   <span class="stringliteral">"pipe_filename"</span>,        &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#5754365db059e54caaaea5020cc821d2">pipeName</a>,      <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2c2958f8037785e8e7cd1d500d6bb9ed2">A_STRING</a> },
<a name="l00082"></a>00082   <span class="comment">/* 2 */</span>  { <span class="stringliteral">"--file"</span>,      <span class="stringliteral">"-f"</span>,   <span class="stringliteral">"file_name"</span>,            &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#3f00b76063285cd0d1bd50a86dbeb92f">fileName</a>,      <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2c2958f8037785e8e7cd1d500d6bb9ed2">A_STRING</a> },
<a name="l00083"></a>00083   <span class="comment">/* 3 */</span>  { <span class="stringliteral">"--firewire"</span>,  <span class="stringliteral">"-i"</span>,   <span class="stringliteral">"fw_node"</span>,              &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c114dc35d6ea615cc0f06cb664fe302a">fwNode</a>,        <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">A_INT</a> },
<a name="l00084"></a>00084   <span class="comment">/* 4 */</span>  { <span class="stringliteral">"--config"</span>,    <span class="stringliteral">"-c"</span>,   <span class="stringliteral">"config_filename"</span>,      &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#f2562ebcc61f9196bfe9bde09743e0a8">configName</a>,    <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2c2958f8037785e8e7cd1d500d6bb9ed2">A_STRING</a> },
<a name="l00085"></a>00085   <span class="comment">/* 5 */</span>  { <span class="stringliteral">"--width"</span>,     <span class="stringliteral">"-w"</span>,   <span class="stringliteral">"width"</span>,                &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#bdb92beff90cfeeddac3feb7a1a74d64">width</a>,         <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">A_INT</a> },
<a name="l00086"></a>00086   <span class="comment">/* 6 */</span>  { <span class="stringliteral">"--height"</span>,    <span class="stringliteral">"-h"</span>,   <span class="stringliteral">"height"</span>,               &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#639b62946ad9df187f74c2bbaea94058">height</a>,        <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">A_INT</a> },
<a name="l00087"></a>00087   <span class="comment">/* 7 */</span>  { <span class="stringliteral">"--fullscreen"</span>,<span class="stringliteral">"-F"</span>,   <span class="stringliteral">""</span>,                     &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#15184328111fdbb45b30d42d74e21df2">fullscreen</a>,    <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">A_NONE</a> },
<a name="l00088"></a>00088   <span class="comment">/* 8 */</span>  { <span class="stringliteral">"--help"</span>,      <span class="stringliteral">"-?"</span>,   <span class="stringliteral">""</span>,                     &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#aeb31edf37162045e4a769cbb75051af">help</a>,          <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">A_NONE</a> },
<a name="l00089"></a>00089   <span class="comment">/* 9 */</span>  { <span class="stringliteral">"--dump"</span>,      <span class="stringliteral">"-d"</span>,   <span class="stringliteral">""</span>,                     &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c078fecdc60ecdadfe6120a72234ebf2">dump</a>,          <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">A_NONE</a> },
<a name="l00090"></a>00090   <span class="comment">/* 10 */</span> { <span class="stringliteral">"--owidth"</span>,    <span class="stringliteral">"-ow"</span>,  <span class="stringliteral">"output_video_width"</span>,   &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#33e331e45d37d0804408fa1c132ca88e">outputWidth</a>,   <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">A_INT</a> },
<a name="l00091"></a>00091   <span class="comment">/* 11 */</span> { <span class="stringliteral">"--oheight"</span>,   <span class="stringliteral">"-oh"</span>,  <span class="stringliteral">"output_video_height"</span>,  &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#865ff7e96699933398dbaaa0b67de836">outputHeight</a>,  <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">A_INT</a> },
<a name="l00092"></a>00092   <span class="comment">/* 12 */</span> { <span class="stringliteral">"--output"</span>,    <span class="stringliteral">"-o"</span>,   <span class="stringliteral">"output_filename"</span>,      &amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c927c84494708366ca26a7a3816c2301">outputName</a>,    <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2c2958f8037785e8e7cd1d500d6bb9ed2">A_STRING</a> }
<a name="l00093"></a>00093 };
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="comment">// sekvence</span>
<a name="l00096"></a><a class="code" href="structSequenceEntry__t.html">00096</a> <span class="keyword">struct </span><a class="code" href="structSequenceEntry__t.html">SequenceEntry_t</a>
<a name="l00097"></a>00097 {
<a name="l00098"></a><a class="code" href="structSequenceEntry__t.html#c910890b5e112bcd6705c3e92fed27a6">00098</a>     <span class="keywordtype">int</span>             <a class="code" href="structSequenceEntry__t.html#c910890b5e112bcd6705c3e92fed27a6">filter</a>;
<a name="l00099"></a><a class="code" href="structSequenceEntry__t.html#4d9796679639d8b5e69bde743f3e1b22">00099</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   <a class="code" href="structSequenceEntry__t.html#4d9796679639d8b5e69bde743f3e1b22">period</a>;
<a name="l00100"></a><a class="code" href="structSequenceEntry__t.html#a7514ee809f58448eb1e57422a7db90f">00100</a>     <a class="code" href="VideoFilter_8h.html#549604e96cf240f46e733b249806da5c">FilterConfig_t</a>  <a class="code" href="structSequenceEntry__t.html#a7514ee809f58448eb1e57422a7db90f">config</a>;
<a name="l00101"></a><a class="code" href="structSequenceEntry__t.html#e5121c71d119eb8772e16bcdf3735d4f">00101</a>     <a class="code" href="VideoFilter_8h.html#549604e96cf240f46e733b249806da5c">FilterConfig_t</a>  <a class="code" href="structSequenceEntry__t.html#e5121c71d119eb8772e16bcdf3735d4f">config_orig</a>;
<a name="l00102"></a>00102 };
<a name="l00103"></a>00103 
<a name="l00105"></a><a class="code" href="main_8cpp.html#30b9533b238a5be353a534cc300d9d84">00105</a> <span class="keyword">typedef</span> vector&lt;SequenceEntry_t&gt; <a class="code" href="main_8cpp.html#30b9533b238a5be353a534cc300d9d84" title="pomocny typ - vektor sekvenci">SequenceVector_t</a>;
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="structSequence__t.html">00107</a> <span class="keyword">struct </span><a class="code" href="structSequence__t.html">Sequence_t</a>
<a name="l00108"></a>00108 {
<a name="l00109"></a><a class="code" href="structSequence__t.html#abc6f590d9555ee0bd370acc66102eb1">00109</a>     <span class="keywordtype">string</span>              <a class="code" href="structSequence__t.html#abc6f590d9555ee0bd370acc66102eb1">name</a>;
<a name="l00110"></a><a class="code" href="structSequence__t.html#d1cb445e7f2fec19d821d32c4357d151">00110</a>     <a class="code" href="main_8cpp.html#30b9533b238a5be353a534cc300d9d84" title="pomocny typ - vektor sekvenci">SequenceVector_t</a>    <a class="code" href="structSequence__t.html#d1cb445e7f2fec19d821d32c4357d151">entry</a>;
<a name="l00111"></a>00111 }<a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[<a class="code" href="main_8cpp.html#b0fe344a06a86782503c655929714de0">SEQUENCE_COUNT</a>];
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">00113</a> <span class="keywordtype">int</span>     <a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a> = <a class="code" href="main_8cpp.html#418fe1f731f76cdbe573e192c72dd497">NO_SEQUENCE</a>;
<a name="l00114"></a><a class="code" href="main_8cpp.html#958524cd87f36b454503d70a204e9e90">00114</a> <span class="keywordtype">long</span>    <a class="code" href="main_8cpp.html#958524cd87f36b454503d70a204e9e90">active_time</a>;
<a name="l00115"></a>00115 
<a name="l00121"></a><a class="code" href="main_8cpp.html#ec2fc670ff36af49668fc6750e988d62">00121</a> <span class="keywordtype">bool</span> <a class="code" href="main_8cpp.html#ec2fc670ff36af49668fc6750e988d62">parse_args</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123     <span class="keywordtype">int</span>  arg = 1;
<a name="l00124"></a>00124     <span class="keywordtype">int</span>  *inta;
<a name="l00125"></a>00125     <span class="keywordtype">bool</span> *boola;
<a name="l00126"></a>00126     <span class="keywordtype">char</span> *chara;
<a name="l00127"></a>00127     <span class="keywordtype">bool</span> options_set[<a class="code" href="main_8cpp.html#3d55bd9b399beca55d56d719de52243f">OPTIONS_SIZE</a>];
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     memset(options_set, 0, <a class="code" href="main_8cpp.html#3d55bd9b399beca55d56d719de52243f">OPTIONS_SIZE</a>);
<a name="l00130"></a>00130     memset(&amp;<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="structOptions__t.html">Options_t</a>));
<a name="l00131"></a>00131     <span class="keywordflow">while</span>(arg &lt; argc)
<a name="l00132"></a>00132     {
<a name="l00133"></a>00133         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="main_8cpp.html#3d55bd9b399beca55d56d719de52243f">OPTIONS_SIZE</a>;i++)
<a name="l00134"></a>00134         {
<a name="l00135"></a>00135             <span class="keywordflow">if</span>(strcmp(options_config[i].arg_text, argv[arg]) == 0 || strcmp(options_config[i].arg_alt, argv[arg]) == 0)
<a name="l00136"></a>00136             {
<a name="l00137"></a>00137                 <span class="keywordflow">if</span>(options_set[i])
<a name="l00138"></a>00138                 {
<a name="l00139"></a>00139                     cerr &lt;&lt; <span class="stringliteral">"Duplicitni parametr: "</span> &lt;&lt; argv[arg] &lt;&lt; endl;
<a name="l00140"></a>00140                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00141"></a>00141                 }
<a name="l00142"></a>00142                 options_set[i] = <span class="keyword">true</span>;
<a name="l00143"></a>00143                 <span class="keywordflow">switch</span>(options_config[i].type)
<a name="l00144"></a>00144                 {
<a name="l00145"></a>00145                 <span class="keywordflow">case</span> <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">A_NONE</a>:
<a name="l00146"></a>00146                     boola = (<span class="keywordtype">bool</span>*)options_config[i].pointer;
<a name="l00147"></a>00147                     *boola = <span class="keyword">true</span>;
<a name="l00148"></a>00148                     <span class="keywordflow">break</span>;
<a name="l00149"></a>00149                 <span class="keywordflow">case</span> <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2db1ffddd5ca448451bfe2b8be2b3b204">A_INT</a>:
<a name="l00150"></a>00150                     <span class="keywordflow">if</span>(arg == argc-1) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00151"></a>00151                     inta = (<span class="keywordtype">int</span>*)options_config[i].pointer;
<a name="l00152"></a>00152                     *inta = atoi(argv[++arg]);
<a name="l00153"></a>00153                     <span class="keywordflow">break</span>;
<a name="l00154"></a>00154                 <span class="keywordflow">case</span> <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb2c2958f8037785e8e7cd1d500d6bb9ed2">A_STRING</a>:
<a name="l00155"></a>00155                     <span class="keywordflow">if</span>(arg == argc-1) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00156"></a>00156                     chara = (<span class="keywordtype">char</span>*)options_config[i].pointer;
<a name="l00157"></a>00157                     strcpy(chara, argv[++arg]);
<a name="l00158"></a>00158                     <span class="keywordflow">break</span>;
<a name="l00159"></a>00159                 }
<a name="l00160"></a>00160                 <span class="keywordflow">break</span>;
<a name="l00161"></a>00161             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(i == OPTIONS_SIZE-1) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163         arg++;
<a name="l00164"></a>00164     }
<a name="l00165"></a>00165     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 
<a name="l00170"></a><a class="code" href="main_8cpp.html#853216ac51aa181669ff4d3de74058a7">00170</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#853216ac51aa181669ff4d3de74058a7">print_help</a>()
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172     cout &lt;&lt; <span class="stringliteral">"   Parametry:"</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">"     "</span>;
<a name="l00173"></a>00173     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="main_8cpp.html#3d55bd9b399beca55d56d719de52243f">OPTIONS_SIZE</a>;i++)
<a name="l00174"></a>00174     {
<a name="l00175"></a>00175         <span class="keywordflow">if</span>(options_config[i].type != <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">A_NONE</a>)
<a name="l00176"></a>00176             cout &lt;&lt; <span class="stringliteral">"["</span>;
<a name="l00177"></a>00177         cout &lt;&lt; <span class="stringliteral">"["</span> &lt;&lt; options_config[i].<a class="code" href="structArgs__t.html#7fde81cc9f73ac6b03240ddab496a1a0" title="text parametru">arg_text</a> &lt;&lt; <span class="stringliteral">" | "</span> &lt;&lt; options_config[i].<a class="code" href="structArgs__t.html#46a82d76ef0bed223bc62ee579d23739" title="alternativni text">arg_alt</a>;
<a name="l00178"></a>00178         <span class="keywordflow">if</span>(options_config[i].type != <a class="code" href="main_8cpp.html#e07e7f0f3d76ae1309217641da872eb240e14063133980754132ed5bd9d217a7">A_NONE</a>)
<a name="l00179"></a>00179             cout &lt;&lt; <span class="stringliteral">"] "</span> &lt;&lt; options_config[i].<a class="code" href="structArgs__t.html#0200da8cba0bc77b9d381728721a6705" title="napoveda parametru">help</a>;
<a name="l00180"></a>00180         cout &lt;&lt; <span class="stringliteral">"]"</span> &lt;&lt; (i&lt;OPTIONS_SIZE-1 ? <span class="stringliteral">" "</span> : <span class="stringliteral">""</span>);
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182     cout &lt;&lt; endl;
<a name="l00183"></a>00183 }
<a name="l00184"></a>00184 
<a name="l00190"></a><a class="code" href="main_8cpp.html#975cab34c692c36075fc64ff6f210283">00190</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#975cab34c692c36075fc64ff6f210283">read_pair</a>(<span class="keywordtype">char</span> *line, <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> &amp;value)
<a name="l00191"></a>00191 {
<a name="l00192"></a>00192     <span class="keywordtype">int</span> index = 0;
<a name="l00193"></a>00193     <span class="keywordtype">int</span> index2 = 0;
<a name="l00194"></a>00194     <span class="keywordtype">char</span> tmp[256];
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="keywordflow">while</span>(line[index] != <span class="charliteral">'='</span> &amp;&amp; (<span class="keywordtype">size_t</span>)index &lt; strlen(line))
<a name="l00197"></a>00197     {
<a name="l00198"></a>00198         name[index] = line[index];
<a name="l00199"></a>00199         index++;
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201     name[index++] = 0;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203     <span class="keywordflow">while</span>(line[index] != 0) tmp[index2++] = line[index++];
<a name="l00204"></a>00204     tmp[index2] = 0;
<a name="l00205"></a>00205     value = atof(tmp);
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00212"></a><a class="code" href="main_8cpp.html#5505b05b61299ab36808018d0dd17547">00212</a> <span class="keywordtype">bool</span> <a class="code" href="main_8cpp.html#5505b05b61299ab36808018d0dd17547">read_config</a>(ifstream &amp;f)
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214     <a class="code" href="structSequenceEntry__t.html">SequenceEntry_t</a>     *entry;
<a name="l00215"></a>00215     <a class="code" href="VideoFilter_8h.html#549604e96cf240f46e733b249806da5c">FilterConfig_t</a> config;
<a name="l00216"></a>00216     <span class="keywordtype">char</span> line[256], name[256];
<a name="l00217"></a>00217     <span class="keywordtype">int</span> index = 0;
<a name="l00218"></a>00218     <span class="keywordtype">int</span> line_nr = 0;
<a name="l00219"></a>00219     <span class="keywordtype">double</span> value;
<a name="l00220"></a>00220     <a class="code" href="classCVideoFilter.html">CVideoFilter</a> *filter = NULL;
<a name="l00221"></a>00221     <span class="keywordflow">while</span>(f.good())
<a name="l00222"></a>00222     {
<a name="l00223"></a>00223         f.getline(line, 256);
<a name="l00224"></a>00224         line_nr++;
<a name="l00225"></a>00225         <span class="keywordflow">if</span>(strlen(line) == 0) <span class="keywordflow">continue</span>; <span class="comment">// prazdny radek</span>
<a name="l00226"></a>00226         <span class="keywordflow">if</span>(line[0] == <span class="charliteral">'#'</span>) <span class="keywordflow">continue</span>; <span class="comment">// komentar</span>
<a name="l00227"></a>00227         <span class="keywordflow">if</span>(line[0] == <span class="charliteral">'$'</span>)
<a name="l00228"></a>00228         {
<a name="l00229"></a>00229             <span class="keywordflow">if</span>(filter) filter-&gt;<a class="code" href="classCVideoFilter.html#851c6abfd74e952da520fd70577cb88e">Config</a>(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, config);
<a name="l00230"></a>00230             filter = NULL;
<a name="l00231"></a>00231             <a class="code" href="main_8cpp.html#5bc28e363ce09640d06d11264b58a42a" title="obsahuje sekvence">contain_sequences</a> = <span class="keyword">true</span>;
<a name="l00232"></a>00232         }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234         <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#5bc28e363ce09640d06d11264b58a42a" title="obsahuje sekvence">contain_sequences</a>)
<a name="l00235"></a>00235         {   <span class="comment">// nacitani sekvenci</span>
<a name="l00236"></a>00236             <span class="keywordflow">switch</span>(line[0])
<a name="l00237"></a>00237             {
<a name="l00238"></a>00238             <span class="keywordflow">case</span> <span class="charliteral">'$'</span>: <span class="comment">// zahajeni sekvence</span>
<a name="l00239"></a>00239                 memcpy(name, line+1, strlen(line)-1);
<a name="l00240"></a>00240                 name[strlen(line)-1] = <span class="charliteral">'\0'</span>;
<a name="l00241"></a>00241                 index = atoi(name);
<a name="l00242"></a>00242                 <span class="keywordflow">if</span>(index &lt; 0 || index &gt;= <a class="code" href="main_8cpp.html#b0fe344a06a86782503c655929714de0">SEQUENCE_COUNT</a>)
<a name="l00243"></a>00243                 {
<a name="l00244"></a>00244                     cerr &lt;&lt; <span class="stringliteral">"Chybne cislo sekvence: "</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">" na radku "</span> &lt;&lt; line_nr &lt;&lt; endl;
<a name="l00245"></a>00245                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00246"></a>00246                 }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248                 <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">"Nacitam sekvenci "</span> &lt;&lt; index &lt;&lt; endl);
<a name="l00249"></a>00249                 <span class="keywordflow">continue</span>;
<a name="l00250"></a>00250             <span class="keywordflow">case</span> <span class="charliteral">'_'</span>: <span class="comment">// nacteni parametru</span>
<a name="l00251"></a>00251                 <a class="code" href="main_8cpp.html#975cab34c692c36075fc64ff6f210283">read_pair</a>(line+1, name, value);
<a name="l00252"></a>00252                 <span class="keywordflow">if</span>(entry==NULL) <span class="keywordflow">continue</span>;
<a name="l00253"></a>00253                 entry-&gt;<a class="code" href="structSequenceEntry__t.html#a7514ee809f58448eb1e57422a7db90f">config</a>[name] = value;
<a name="l00254"></a>00254 
<a name="l00255"></a>00255                 <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">"Nacteni parametru "</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">" na hodnotu "</span> &lt;&lt; value &lt;&lt; endl);
<a name="l00256"></a>00256                 <span class="keywordflow">break</span>;
<a name="l00257"></a>00257             <span class="keywordflow">default</span>:
<a name="l00258"></a>00258                 <a class="code" href="main_8cpp.html#975cab34c692c36075fc64ff6f210283">read_pair</a>(line, name, value);
<a name="l00259"></a>00259                 <span class="keywordflow">if</span>(strcmp(name, <span class="stringliteral">"filter"</span>) == 0)
<a name="l00260"></a>00260                 {
<a name="l00261"></a>00261                     <a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[index].<a class="code" href="structSequence__t.html#d1cb445e7f2fec19d821d32c4357d151">entry</a>.push_back(<a class="code" href="structSequenceEntry__t.html">SequenceEntry_t</a>());
<a name="l00262"></a>00262                     entry = &amp;<a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[index].<a class="code" href="structSequence__t.html#d1cb445e7f2fec19d821d32c4357d151">entry</a>.back();
<a name="l00263"></a>00263                     <span class="keywordflow">if</span>(value &lt; 1 || (<span class="keywordtype">size_t</span>)value &gt; <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.size())
<a name="l00264"></a>00264                     {
<a name="l00265"></a>00265                         cerr &lt;&lt; <span class="stringliteral">"Chybne cislo filtru: "</span> &lt;&lt; (int)value &lt;&lt; <span class="stringliteral">" na radku "</span> &lt;&lt; line_nr &lt;&lt; endl;
<a name="l00266"></a>00266                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00267"></a>00267                     }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269                     entry-&gt;<a class="code" href="structSequenceEntry__t.html#c910890b5e112bcd6705c3e92fed27a6">filter</a> = (int)value-1;
<a name="l00270"></a>00270                     <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">" &gt;&gt; entry.filter = "</span> &lt;&lt; value &lt;&lt; endl);
<a name="l00271"></a>00271                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(name, <span class="stringliteral">"time"</span>) == 0)
<a name="l00272"></a>00272                 {
<a name="l00273"></a>00273                     <span class="keywordflow">if</span>(entry==NULL) <span class="keywordflow">continue</span>;
<a name="l00274"></a>00274                     entry-&gt;<a class="code" href="structSequenceEntry__t.html#4d9796679639d8b5e69bde743f3e1b22">period</a> = (int)value;
<a name="l00275"></a>00275                     <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">" &gt;&gt; entry.period = "</span> &lt;&lt; value &lt;&lt; endl);
<a name="l00276"></a>00276                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(name, <span class="stringliteral">"name"</span>) == 0)
<a name="l00277"></a>00277                 {
<a name="l00278"></a>00278                     <a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[index].<a class="code" href="structSequence__t.html#abc6f590d9555ee0bd370acc66102eb1">name</a> = string(line+strlen(name)+1);
<a name="l00279"></a>00279                 }<span class="keywordflow">else</span>
<a name="l00280"></a>00280                 {
<a name="l00281"></a>00281                     cerr &lt;&lt; <span class="stringliteral">"Neznamy parametr "</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">" = "</span> &lt;&lt; value &lt;&lt; <span class="stringliteral">" na radku "</span> &lt;&lt; line_nr &lt;&lt; endl;
<a name="l00282"></a>00282                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00283"></a>00283                 }
<a name="l00284"></a>00284                 <span class="keywordflow">break</span>;
<a name="l00285"></a>00285             }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287         }<span class="keywordflow">else</span>
<a name="l00288"></a>00288         {   <span class="comment">// defaultni nastaveni filtru</span>
<a name="l00289"></a>00289             <span class="keywordflow">if</span>(line[0] == <span class="charliteral">'_'</span>)
<a name="l00290"></a>00290             {
<a name="l00291"></a>00291                 <a class="code" href="main_8cpp.html#975cab34c692c36075fc64ff6f210283">read_pair</a>(line+1, name, value);
<a name="l00292"></a>00292                 <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">"name="</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">", value="</span> &lt;&lt; value &lt;&lt; endl);
<a name="l00293"></a>00293                 config[name] = value;
<a name="l00294"></a>00294             }<span class="keywordflow">else</span>
<a name="l00295"></a>00295             {
<a name="l00296"></a>00296                 memcpy(name, line, strlen(line));
<a name="l00297"></a>00297                 name[strlen(line)] = <span class="charliteral">'\0'</span>;
<a name="l00298"></a>00298                 <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">"Filter: '"</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">"'"</span> &lt;&lt; endl);
<a name="l00299"></a>00299                 <span class="keywordflow">if</span>(filter) filter-&gt;<a class="code" href="classCVideoFilter.html#851c6abfd74e952da520fd70577cb88e">Config</a>(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, config);
<a name="l00300"></a>00300                 config.clear();
<a name="l00301"></a>00301                 filter = <a class="code" href="classCFilterFactory.html#139ee88042bb34ee2dd7f8d33b66b1df">CFilterFactory::CreateInstance</a>(name);
<a name="l00302"></a>00302                 <span class="keywordflow">if</span>(filter) <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(filter);
<a name="l00303"></a>00303                 <span class="keywordflow">else</span>
<a name="l00304"></a>00304                 {
<a name="l00305"></a>00305                     cerr &lt;&lt; <span class="stringliteral">"Neznamy filtr '"</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">"', radek "</span> &lt;&lt; line_nr &lt;&lt; endl;
<a name="l00306"></a>00306                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00307"></a>00307                 }
<a name="l00308"></a>00308                 <span class="keywordflow">continue</span>;
<a name="l00309"></a>00309             }
<a name="l00310"></a>00310         }
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312     <span class="keywordflow">if</span>(filter) filter-&gt;<a class="code" href="classCVideoFilter.html#851c6abfd74e952da520fd70577cb88e">Config</a>(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, config);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314     <span class="comment">/*for(int i=0;i&lt;SEQUENCE_COUNT;i++)</span>
<a name="l00315"></a>00315 <span class="comment">    {</span>
<a name="l00316"></a>00316 <span class="comment">        //DEBUG_OUT("sequence[" &lt;&lt; i &lt;&lt; "].entry.size() = " &lt;&lt; sequence[i].entry.size() &lt;&lt; endl);</span>
<a name="l00317"></a>00317 <span class="comment">        for(SequenceVector_t::const_iterator it=sequence[i].entry.begin();it!=sequence[i].entry.end();it++)</span>
<a name="l00318"></a>00318 <span class="comment">        {</span>
<a name="l00319"></a>00319 <span class="comment">            DEBUG_OUT(" - filter=" &lt;&lt; it-&gt;filter &lt;&lt; endl);</span>
<a name="l00320"></a>00320 <span class="comment">            DEBUG_OUT(" - period=" &lt;&lt; it-&gt;period &lt;&lt; endl);</span>
<a name="l00321"></a>00321 <span class="comment">            for(FilterConfig_t::const_iterator it2=(*it).config.begin(); it2 != (*it).config.end(); it2++)</span>
<a name="l00322"></a>00322 <span class="comment">            {</span>
<a name="l00323"></a>00323 <span class="comment">                DEBUG_OUT(" --- " &lt;&lt; it2-&gt;first &lt;&lt; " = " &lt;&lt; it2-&gt;second &lt;&lt; endl);</span>
<a name="l00324"></a>00324 <span class="comment">            }</span>
<a name="l00325"></a>00325 <span class="comment">        }</span>
<a name="l00326"></a>00326 <span class="comment">    }*/</span>
<a name="l00327"></a>00327     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00328"></a>00328 }
<a name="l00329"></a>00329 
<a name="l00332"></a><a class="code" href="main_8cpp.html#60e3a7964d5955d6dc34ef1613bfd065">00332</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#60e3a7964d5955d6dc34ef1613bfd065">save_config</a>()
<a name="l00333"></a>00333 {
<a name="l00334"></a>00334     <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">"Ukladam konfiguraci"</span> &lt;&lt; endl);
<a name="l00335"></a>00335     ofstream f;
<a name="l00336"></a>00336     f.open(<span class="stringliteral">"config.cfg"</span>, fstream::out);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338     <a class="code" href="VideoFilter_8h.html#549604e96cf240f46e733b249806da5c">FilterConfig_t</a> conf;
<a name="l00339"></a>00339     <span class="keywordtype">string</span> name;
<a name="l00340"></a>00340     <span class="keywordtype">char</span> buffer[256];
<a name="l00341"></a>00341     <span class="keywordflow">for</span>(FilterVector_t::const_iterator it=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.begin();it!=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.end();it++)
<a name="l00342"></a>00342     {
<a name="l00343"></a>00343         conf.clear();
<a name="l00344"></a>00344         (*it)-&gt;GetInfo(name, conf);
<a name="l00345"></a>00345         f.write(name.c_str(), name.size());
<a name="l00346"></a>00346         f.write(<span class="stringliteral">"\n"</span>, 1);
<a name="l00347"></a>00347         <span class="keywordflow">for</span>(FilterConfig_t::const_iterator it2=conf.begin();it2!=conf.end();it2++)
<a name="l00348"></a>00348         {
<a name="l00349"></a>00349             sprintf(buffer, <span class="stringliteral">"%s=%.2f\n"</span>, (*it2).first.c_str(), (*it2).second);
<a name="l00350"></a>00350             f.write(buffer, strlen(buffer));
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353     f.close();
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00359"></a><a class="code" href="main_8cpp.html#ba67695c0ab81949cad2f1a1bdae4657">00359</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#ba67695c0ab81949cad2f1a1bdae4657">render_help</a>(BITMAP *bmp)
<a name="l00360"></a>00360 {
<a name="l00361"></a>00361     <span class="keywordtype">int</span> tcolor = makecol(0, 0, 0);
<a name="l00362"></a>00362     <span class="keywordtype">int</span> bcolor = makecol(255, 255, 0);
<a name="l00363"></a>00363     <span class="keywordtype">int</span> vpos = 20, hpos = SCREEN_H - 110, y = 0;
<a name="l00364"></a>00364     rectfill(bmp, vpos, hpos, 480, SCREEN_H - 20, bcolor);
<a name="l00365"></a>00365     textout_ex(bmp, font, <span class="stringliteral">"NUMPAD 7/9    +/- 1.00"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00366"></a>00366     textout_ex(bmp, font, <span class="stringliteral">"NUMPAD 4/6    +/- 0.10"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00367"></a>00367     textout_ex(bmp, font, <span class="stringliteral">"NUMPAD 1/3    +/- 0.01"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00368"></a>00368     y++;
<a name="l00369"></a>00369     textout_ex(bmp, font, <span class="stringliteral">"DEL    - remove filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00370"></a>00370     textout_ex(bmp, font, <span class="stringliteral">"PGUP   - move filter left"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00371"></a>00371     textout_ex(bmp, font, <span class="stringliteral">"PDDOWN - move filter right"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00372"></a>00372     textout_ex(bmp, font, <span class="stringliteral">"S      - save configuration"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     y = 0;
<a name="l00375"></a>00375     vpos = 250;
<a name="l00376"></a>00376     textout_ex(bmp, font, <span class="stringliteral">"1 - insert Color filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00377"></a>00377     textout_ex(bmp, font, <span class="stringliteral">"2 - insert Wave filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00378"></a>00378     textout_ex(bmp, font, <span class="stringliteral">"3 - insert Delay filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00379"></a>00379     textout_ex(bmp, font, <span class="stringliteral">"4 - insert Treshold filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00380"></a>00380     textout_ex(bmp, font, <span class="stringliteral">"5 - insert Blur filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00381"></a>00381     textout_ex(bmp, font, <span class="stringliteral">"6 - insert Weight filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00382"></a>00382     textout_ex(bmp, font, <span class="stringliteral">"7 - insert Grayscale filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00383"></a>00383     textout_ex(bmp, font, <span class="stringliteral">"8 - insert Square filter"</span>, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00384"></a>00384 }
<a name="l00385"></a>00385 
<a name="l00389"></a><a class="code" href="main_8cpp.html#a4609ae8e788af0627181bbb17a8aaf6">00389</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#a4609ae8e788af0627181bbb17a8aaf6">handle_sequences</a>(<span class="keywordtype">bool</span> *keyp)
<a name="l00390"></a>00390 {
<a name="l00391"></a>00391     tms tm;
<a name="l00392"></a>00392     <span class="keywordtype">long</span> current_time = times(&amp;tm);
<a name="l00393"></a>00393     <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a> != <a class="code" href="main_8cpp.html#418fe1f731f76cdbe573e192c72dd497">NO_SEQUENCE</a>)
<a name="l00394"></a>00394     {
<a name="l00395"></a>00395         <span class="keywordtype">bool</span> done = <span class="keyword">true</span>;
<a name="l00396"></a>00396         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elapsed_time = (current_time - <a class="code" href="main_8cpp.html#958524cd87f36b454503d70a204e9e90">active_time</a>)*10;
<a name="l00397"></a>00397         <span class="keywordtype">double</span> percent;
<a name="l00398"></a>00398         <a class="code" href="VideoFilter_8h.html#549604e96cf240f46e733b249806da5c">FilterConfig_t</a> config;
<a name="l00399"></a>00399 
<a name="l00400"></a>00400         <span class="comment">// projedu aktivni sekvenci a nastavim filtry</span>
<a name="l00401"></a>00401         <span class="keywordflow">for</span>(SequenceVector_t::iterator it=<a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[<a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a>].entry.begin(), end=<a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[<a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a>].<a class="code" href="structSequence__t.html#d1cb445e7f2fec19d821d32c4357d151">entry</a>.end();it!=end;it++)
<a name="l00402"></a>00402         {
<a name="l00403"></a>00403             <span class="keywordflow">if</span>(elapsed_time &lt; it-&gt;period)
<a name="l00404"></a>00404             {
<a name="l00405"></a>00405                 done = <span class="keyword">false</span>; <span class="comment">// aspon jeden filter se nedokoncil</span>
<a name="l00406"></a>00406                 percent = (double)elapsed_time/(<span class="keywordtype">double</span>)it-&gt;period;
<a name="l00407"></a>00407             }<span class="keywordflow">else</span>
<a name="l00408"></a>00408                 percent = 1.0f;
<a name="l00409"></a>00409 
<a name="l00410"></a>00410             <span class="comment">// vypocitam nove nastaveni</span>
<a name="l00411"></a>00411             <span class="keywordflow">for</span>(FilterConfig_t::const_iterator it2=it-&gt;config.begin(), end2=it-&gt;config.end(); it2 != end2; it2++)
<a name="l00412"></a>00412             {
<a name="l00413"></a>00413                 config[it2-&gt;first] = it-&gt;config_orig[it2-&gt;first] + percent*(it2-&gt;second - it-&gt;config_orig[it2-&gt;first]);
<a name="l00414"></a>00414             }
<a name="l00415"></a>00415 
<a name="l00416"></a>00416             <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[it-&gt;filter] != NULL)
<a name="l00417"></a>00417                 <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[it-&gt;filter]-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, config);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419             <span class="comment">//DEBUG_OUT("Nastavuju filter: " &lt;&lt; it-&gt;filter &lt;&lt; "(" &lt;&lt; percent &lt;&lt; "%)" &lt;&lt; endl);</span>
<a name="l00420"></a>00420         }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422         <span class="comment">//DEBUG_OUT("time elapsed=" &lt;&lt; (currentTime - activeTime) &lt;&lt; endl);</span>
<a name="l00423"></a>00423         <span class="keywordflow">if</span>(done) <a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a> = <a class="code" href="main_8cpp.html#418fe1f731f76cdbe573e192c72dd497">NO_SEQUENCE</a>;
<a name="l00424"></a>00424         <span class="comment">//if(done) DEBUG_OUT("hotovo" &lt;&lt; endl);</span>
<a name="l00425"></a>00425     }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=KEY_F1;i&lt;=KEY_F12;i++)
<a name="l00428"></a>00428     {   <span class="comment">// provede se prvni stisknuta sekvence</span>
<a name="l00429"></a>00429         <span class="keywordflow">if</span>(keyp[i])
<a name="l00430"></a>00430         {
<a name="l00431"></a>00431             <a class="code" href="main_8cpp.html#958524cd87f36b454503d70a204e9e90">active_time</a> = current_time;
<a name="l00432"></a>00432             <a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a> = i - KEY_F1;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434             <span class="keywordtype">string</span> tmp;
<a name="l00435"></a>00435             <span class="keywordflow">for</span>(SequenceVector_t::iterator it=<a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[<a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a>].entry.begin(), end=<a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[<a class="code" href="main_8cpp.html#6bb0b17157002e2d0e3bc1ae6c93b5b3">active_sequence</a>].<a class="code" href="structSequence__t.html#d1cb445e7f2fec19d821d32c4357d151">entry</a>.end();it!=end;it++)
<a name="l00436"></a>00436             {
<a name="l00437"></a>00437                 <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[it-&gt;filter]-&gt;GetInfo(tmp, it-&gt;config_orig);
<a name="l00438"></a>00438             }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440             <a class="code" href="main_8cpp.html#b0c7932a38248a4a2527c35dc39564cb">DEBUG_OUT</a>(<span class="stringliteral">"activeTime: "</span> &lt;&lt; <a class="code" href="main_8cpp.html#958524cd87f36b454503d70a204e9e90">active_time</a> &lt;&lt; endl);
<a name="l00441"></a>00441             <span class="keywordflow">break</span>;
<a name="l00442"></a>00442         }
<a name="l00443"></a>00443     }
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00449"></a><a class="code" href="main_8cpp.html#40b3e73ea16926300f2b43367eeaf1be">00449</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#40b3e73ea16926300f2b43367eeaf1be">render_options</a>(BITMAP *bbuffer)
<a name="l00450"></a>00450 {
<a name="l00451"></a>00451     <span class="keywordtype">string</span> name;
<a name="l00452"></a>00452     <a class="code" href="VideoFilter_8h.html#549604e96cf240f46e733b249806da5c">FilterConfig_t</a> info;
<a name="l00453"></a>00453     <span class="keywordtype">int</span> x = 20, y;
<a name="l00454"></a>00454     <span class="keywordtype">int</span> count = 0;
<a name="l00455"></a>00455     <span class="keywordtype">int</span> color;
<a name="l00456"></a>00456     <span class="keywordtype">char</span> buffer[256];
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="keywordflow">for</span>(FilterVector_t::const_iterator it=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.begin();it!=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.end();it++)
<a name="l00459"></a>00459     {
<a name="l00460"></a>00460         <span class="keywordflow">if</span>((*it)-&gt;isActive())
<a name="l00461"></a>00461             color = (<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> != count ? makecol(128, 128, 128) : makecol(255, 255, 255));
<a name="l00462"></a>00462         <span class="keywordflow">else</span>
<a name="l00463"></a>00463             color = (<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> != count ? makecol(128, 0, 0) : makecol(255, 0, 0));
<a name="l00464"></a>00464 
<a name="l00465"></a>00465         info.clear();
<a name="l00466"></a>00466         (*it)-&gt;GetInfo(name, info);
<a name="l00467"></a>00467         rectfill(bbuffer, x, 0, x + <a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">FILTER_BOX_WIDTH</a> - 10, 28 + info.size()*8, color);
<a name="l00468"></a>00468         rect(bbuffer, x, 0, x + <a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">FILTER_BOX_WIDTH</a> - 10, 29 + info.size()*8, makecol(0, 0, 0));
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         textout_ex(bbuffer, font, name.c_str(), x + 10, 10, makecol(0, 0, 0), color);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472         y = 28;
<a name="l00473"></a>00473         <span class="keywordflow">for</span>(FilterConfig_t::iterator it2=info.begin();it2!=info.end();it2++)
<a name="l00474"></a>00474         {
<a name="l00475"></a>00475             sprintf(buffer, <span class="stringliteral">"%s = %.2f"</span>, it2-&gt;first.c_str(), it2-&gt;second);
<a name="l00476"></a>00476             textout_ex(bbuffer, font, buffer, x + 10, y, makecol(0, 0, 0), color);
<a name="l00477"></a>00477             y += 8;
<a name="l00478"></a>00478         }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480         x += <a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">FILTER_BOX_WIDTH</a>;
<a name="l00481"></a>00481         count++;
<a name="l00482"></a>00482     }
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.size() &gt; 0)
<a name="l00485"></a>00485     {   <span class="comment">// vykresleni kurzoru u nastaveni</span>
<a name="l00486"></a>00486         rectfill(bbuffer, <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> * <a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">FILTER_BOX_WIDTH</a> + 24, <a class="code" href="main_8cpp.html#e21fce8f8c6b4ccc0c77c87562648830" title="y-ova pozice kurzoru">cur_y</a> * 8 + 29, <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> * <a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">FILTER_BOX_WIDTH</a> + 28, <a class="code" href="main_8cpp.html#e21fce8f8c6b4ccc0c77c87562648830" title="y-ova pozice kurzoru">cur_y</a> * 8 + 33, makecol(0, 0, 255));
<a name="l00487"></a>00487         rect(bbuffer, <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> * <a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">FILTER_BOX_WIDTH</a> + 24, <a class="code" href="main_8cpp.html#e21fce8f8c6b4ccc0c77c87562648830" title="y-ova pozice kurzoru">cur_y</a> * 8 + 29, <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> * <a class="code" href="main_8cpp.html#662c34b67b182f85ccee9a5bda35981d">FILTER_BOX_WIDTH</a> + 28, <a class="code" href="main_8cpp.html#e21fce8f8c6b4ccc0c77c87562648830" title="y-ova pozice kurzoru">cur_y</a> * 8 + 33, makecol(255, 0, 0));
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00494"></a><a class="code" href="main_8cpp.html#2b7dd8985d42eb12eae2ddb30341de1e">00494</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#2b7dd8985d42eb12eae2ddb30341de1e">render_sequences</a>(BITMAP *bbuffer)
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496     <span class="keywordtype">int</span> tcolor = makecol(0, 0, 0);
<a name="l00497"></a>00497     <span class="keywordtype">int</span> bcolor = makecol(255, 255, 0);
<a name="l00498"></a>00498     <span class="keywordtype">int</span> vpos = 20, hpos = 20, y = 0;
<a name="l00499"></a>00499     <span class="keywordtype">char</span> text[256];
<a name="l00500"></a>00500     rectfill(bbuffer, vpos, hpos, 470, 120, bcolor);
<a name="l00501"></a>00501     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="main_8cpp.html#b0fe344a06a86782503c655929714de0">SEQUENCE_COUNT</a>;i++)
<a name="l00502"></a>00502     {
<a name="l00503"></a>00503         <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[i].entry.size() == 0) <span class="keywordflow">continue</span>;
<a name="l00504"></a>00504 
<a name="l00505"></a>00505         sprintf(text, <span class="stringliteral">"F%d - %s"</span>, i+1, <a class="code" href="main_8cpp.html#af7f1b97a9ff97a230983e55a3fe5a92">sequence</a>[i].name.c_str());
<a name="l00506"></a>00506         textout_ex(bbuffer, font, text, vpos+10, hpos+10+(y++)*10, tcolor, bcolor);
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508 }
<a name="l00509"></a>00509 
<a name="l00513"></a><a class="code" href="main_8cpp.html#cdb75405f5a62767b0b64ac07dc1936d">00513</a> <span class="keywordtype">void</span> <a class="code" href="main_8cpp.html#cdb75405f5a62767b0b64ac07dc1936d">handle_input</a>(<span class="keywordtype">bool</span> *keyp)
<a name="l00514"></a>00514 {
<a name="l00515"></a>00515     <span class="keywordtype">string</span> name;
<a name="l00516"></a>00516     <a class="code" href="VideoFilter_8h.html#549604e96cf240f46e733b249806da5c">FilterConfig_t</a> info;
<a name="l00517"></a>00517     <span class="keywordtype">int</span> count = <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.size();
<a name="l00518"></a>00518 
<a name="l00519"></a>00519     <span class="keywordflow">if</span>(count &gt; 0)
<a name="l00520"></a>00520     {
<a name="l00521"></a>00521         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>]-&gt;GetInfo(name, info);
<a name="l00522"></a>00522 
<a name="l00523"></a>00523         FilterConfig_t::iterator it = info.begin();
<a name="l00524"></a>00524         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="main_8cpp.html#e21fce8f8c6b4ccc0c77c87562648830" title="y-ova pozice kurzoru">cur_y</a>;i++) it++;
<a name="l00525"></a>00525         <span class="keywordflow">if</span>(keyp[KEY_1_PAD]) info[it-&gt;first] = it-&gt;second - 0.01;
<a name="l00526"></a>00526         <span class="keywordflow">if</span>(keyp[KEY_3_PAD]) info[it-&gt;first] = it-&gt;second + 0.01;
<a name="l00527"></a>00527         <span class="keywordflow">if</span>(keyp[KEY_4_PAD]) info[it-&gt;first] = it-&gt;second - 0.1;
<a name="l00528"></a>00528         <span class="keywordflow">if</span>(keyp[KEY_6_PAD]) info[it-&gt;first] = it-&gt;second + 0.1;
<a name="l00529"></a>00529         <span class="keywordflow">if</span>(keyp[KEY_7_PAD]) info[it-&gt;first] = it-&gt;second - 1.0;
<a name="l00530"></a>00530         <span class="keywordflow">if</span>(keyp[KEY_9_PAD]) info[it-&gt;first] = it-&gt;second + 1.0;
<a name="l00531"></a>00531         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>]-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00532"></a>00532 
<a name="l00533"></a>00533         <span class="comment">// zpracovani klaves</span>
<a name="l00534"></a>00534         <span class="keywordflow">if</span>(keyp[KEY_RIGHT])
<a name="l00535"></a>00535         {
<a name="l00536"></a>00536             <span class="keywordflow">if</span>(++<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> &gt;= count) <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> = count-1;
<a name="l00537"></a>00537             cur_y = 0;
<a name="l00538"></a>00538         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(keyp[KEY_LEFT])
<a name="l00539"></a>00539         {
<a name="l00540"></a>00540             <span class="keywordflow">if</span>(--<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> &lt; 0) <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> = 0;
<a name="l00541"></a>00541             cur_y = 0;
<a name="l00542"></a>00542         }<span class="keywordflow">if</span>(keyp[KEY_PGUP] &amp;&amp; <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> &gt; 0)
<a name="l00543"></a>00543         {
<a name="l00544"></a>00544             <a class="code" href="classCVideoFilter.html">CVideoFilter</a> *tmp = <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>];
<a name="l00545"></a>00545             <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>] = <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>-1];
<a name="l00546"></a>00546             <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>-1] = tmp;
<a name="l00547"></a>00547             <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>--;
<a name="l00548"></a>00548         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(keyp[KEY_PGDN] &amp;&amp; <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> &lt; count-1)
<a name="l00549"></a>00549         {
<a name="l00550"></a>00550             <a class="code" href="classCVideoFilter.html">CVideoFilter</a> *tmp = <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>];
<a name="l00551"></a>00551             <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>] = <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>+1];
<a name="l00552"></a>00552             <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>+1] = tmp;
<a name="l00553"></a>00553             <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>++;
<a name="l00554"></a>00554         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(keyp[KEY_DEL] &amp;&amp; <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.size() &gt; 0)
<a name="l00555"></a>00555         {
<a name="l00556"></a>00556             FilterVector_t::iterator it = <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.begin();
<a name="l00557"></a>00557             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;(i++)&lt;<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>;it++) ;
<a name="l00558"></a>00558             <span class="keyword">delete</span> (*it);
<a name="l00559"></a>00559             <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.erase(it);
<a name="l00560"></a>00560             <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a> &gt; 0) <a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>--;
<a name="l00561"></a>00561             cur_y = 0;
<a name="l00562"></a>00562         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(keyp[KEY_UP])
<a name="l00563"></a>00563         {
<a name="l00564"></a>00564             <span class="keywordflow">if</span>(cur_y &gt; 0) cur_y--;
<a name="l00565"></a>00565         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(keyp[KEY_DOWN])
<a name="l00566"></a>00566         {
<a name="l00567"></a>00567             <span class="keywordflow">if</span>((<span class="keywordtype">size_t</span>)cur_y &lt; info.size()-1) cur_y++;
<a name="l00568"></a>00568         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(keyp[KEY_SPACE])
<a name="l00569"></a>00569         {
<a name="l00570"></a>00570             <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>]-&gt;Activate(!<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>]-&gt;isActive());
<a name="l00571"></a>00571         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(keyp[KEY_D])
<a name="l00572"></a>00572         {
<a name="l00573"></a>00573             <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>[<a class="code" href="main_8cpp.html#5babf8f01695ecf5f7c86ae4422ed79e" title="x-ova pozice kurzoru">cur_x</a>]-&gt;Default();
<a name="l00574"></a>00574         }
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576 
<a name="l00577"></a>00577     <span class="comment">// vlozeni novych filtru</span>
<a name="l00578"></a>00578     <span class="keywordflow">if</span>(keyp[KEY_1])
<a name="l00579"></a>00579     {
<a name="l00580"></a>00580         info.clear();
<a name="l00581"></a>00581         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCColorFilter.html">CColorFilter</a>());
<a name="l00582"></a>00582         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584     <span class="keywordflow">if</span>(keyp[KEY_2])
<a name="l00585"></a>00585     {
<a name="l00586"></a>00586         info.clear();
<a name="l00587"></a>00587         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCWaveFilter.html">CWaveFilter</a>());
<a name="l00588"></a>00588         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00589"></a>00589     }
<a name="l00590"></a>00590     <span class="keywordflow">if</span>(keyp[KEY_3])
<a name="l00591"></a>00591     {
<a name="l00592"></a>00592         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCDelayFilter.html">CDelayFilter</a>());
<a name="l00593"></a>00593         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595     <span class="keywordflow">if</span>(keyp[KEY_4])
<a name="l00596"></a>00596     {
<a name="l00597"></a>00597         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCTreshFilter.html">CTreshFilter</a>());
<a name="l00598"></a>00598         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00599"></a>00599     }
<a name="l00600"></a>00600     <span class="keywordflow">if</span>(keyp[KEY_5])
<a name="l00601"></a>00601     {
<a name="l00602"></a>00602         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCBlurFilter.html">CBlurFilter</a>());
<a name="l00603"></a>00603         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605     <span class="keywordflow">if</span>(keyp[KEY_6])
<a name="l00606"></a>00606     {
<a name="l00607"></a>00607         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCWeightFilter.html">CWeightFilter</a>());
<a name="l00608"></a>00608         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00609"></a>00609     }
<a name="l00610"></a>00610     <span class="keywordflow">if</span>(keyp[KEY_7])
<a name="l00611"></a>00611     {
<a name="l00612"></a>00612         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCGrayFilter.html">CGrayFilter</a>());
<a name="l00613"></a>00613         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00614"></a>00614     }
<a name="l00615"></a>00615     <span class="keywordflow">if</span>(keyp[KEY_8])
<a name="l00616"></a>00616     {
<a name="l00617"></a>00617         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCSquareFilter.html">CSquareFilter</a>());
<a name="l00618"></a>00618         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00619"></a>00619     }
<a name="l00620"></a>00620     <span class="keywordflow">if</span>(keyp[KEY_9])
<a name="l00621"></a>00621     {
<a name="l00622"></a>00622         <a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.push_back(<span class="keyword">new</span> <a class="code" href="classCFadeawayFilter.html">CFadeawayFilter</a>());
<a name="l00623"></a>00623         (<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.back())-&gt;Config(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, info);
<a name="l00624"></a>00624     }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     <span class="comment">// ridici klavesy</span>
<a name="l00627"></a>00627     <span class="keywordflow">if</span>(keyp[KEY_O])   <a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d" title="zobrazovat nastaveni">show_options</a> = !<a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d" title="zobrazovat nastaveni">show_options</a>;
<a name="l00628"></a>00628     <span class="keywordflow">if</span>(keyp[KEY_ESC]) <a class="code" href="main_8cpp.html#752b7698937b6a908ce52deabebfc077" title="ukoncit aplikaci">end_app</a> = <span class="keyword">true</span>;
<a name="l00629"></a>00629     <span class="keywordflow">if</span>(keyp[KEY_S]) <a class="code" href="main_8cpp.html#60e3a7964d5955d6dc34ef1613bfd065">save_config</a>();
<a name="l00630"></a>00630 }
<a name="l00631"></a>00631 
<a name="l00633"></a><a class="code" href="main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97">00633</a> <span class="keywordtype">int</span> <a class="code" href="main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="main">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l00634"></a>00634 {
<a name="l00635"></a>00635     <a class="code" href="classCVideoEncoder.html">CVideoEncoder</a> *encoder = NULL;
<a name="l00636"></a>00636     <a class="code" href="classCDecoder.html">CDecoder</a>    *decoder;
<a name="l00637"></a>00637     BITMAP      *frame;
<a name="l00638"></a>00638     BITMAP      *orig;
<a name="l00639"></a>00639     BITMAP      *bbuffer;
<a name="l00640"></a>00640     <span class="keywordtype">bool</span>        key_pressed[KEY_MAX];
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     <a class="code" href="main_8cpp.html#5bc28e363ce09640d06d11264b58a42a" title="obsahuje sekvence">contain_sequences</a> = <span class="keyword">false</span>;
<a name="l00643"></a>00643     <a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d" title="zobrazovat nastaveni">show_options</a> = <span class="keyword">false</span>;
<a name="l00644"></a>00644     <a class="code" href="main_8cpp.html#752b7698937b6a908ce52deabebfc077" title="ukoncit aplikaci">end_app</a> = <span class="keyword">false</span>;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646     cout &lt;&lt; <span class="stringliteral">"RTVideoFilter"</span>;
<a name="l00647"></a>00647     cout.width(67);
<a name="l00648"></a>00648     cout &lt;&lt; <span class="stringliteral">"Tomas Kotal"</span> &lt;&lt; endl;
<a name="l00649"></a>00649     cout &lt;&lt; <span class="stringliteral">"--------------------------------------------------------------------------------"</span> &lt;&lt; endl &lt;&lt; endl;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651     <span class="comment">// zpracovani parametru</span>
<a name="l00652"></a>00652     <span class="keywordflow">if</span>(!<a class="code" href="main_8cpp.html#ec2fc670ff36af49668fc6750e988d62">parse_args</a>(argc, argv))
<a name="l00653"></a>00653     {
<a name="l00654"></a>00654         cerr &lt;&lt; <span class="stringliteral">"Chybny parametr"</span> &lt;&lt; endl;
<a name="l00655"></a>00655         <a class="code" href="main_8cpp.html#853216ac51aa181669ff4d3de74058a7">print_help</a>();
<a name="l00656"></a>00656         <span class="keywordflow">return</span> -1;
<a name="l00657"></a>00657     }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#aeb31edf37162045e4a769cbb75051af">help</a>)
<a name="l00658"></a>00658     {
<a name="l00659"></a>00659         <a class="code" href="main_8cpp.html#853216ac51aa181669ff4d3de74058a7">print_help</a>();
<a name="l00660"></a>00660         <span class="keywordflow">return</span> 0;
<a name="l00661"></a>00661     }
<a name="l00662"></a>00662 
<a name="l00663"></a>00663         <span class="comment">/*cout &lt;&lt; "Options:" &lt;&lt; endl;</span>
<a name="l00664"></a>00664 <span class="comment">        cout &lt;&lt; "     pipeName: " &lt;&lt; options.pipeName &lt;&lt; endl;</span>
<a name="l00665"></a>00665 <span class="comment">        cout &lt;&lt; "     fileName: " &lt;&lt; options.fileName &lt;&lt; endl;</span>
<a name="l00666"></a>00666 <span class="comment">        cout &lt;&lt; "   configName: " &lt;&lt; options.configName &lt;&lt; endl;</span>
<a name="l00667"></a>00667 <span class="comment">        cout &lt;&lt; "   fullscreen: " &lt;&lt; options.fullscreen &lt;&lt; endl;</span>
<a name="l00668"></a>00668 <span class="comment">        cout &lt;&lt; "         help: " &lt;&lt; options.help &lt;&lt; endl;</span>
<a name="l00669"></a>00669 <span class="comment">        cout &lt;&lt; "        width: " &lt;&lt; options.width &lt;&lt; endl;</span>
<a name="l00670"></a>00670 <span class="comment">        cout &lt;&lt; "       height: " &lt;&lt; options.height &lt;&lt; endl;*/</span>
<a name="l00671"></a>00671 
<a name="l00672"></a>00672     <span class="comment">// inicializace allegra</span>
<a name="l00673"></a>00673     allegro_init();
<a name="l00674"></a>00674     install_keyboard();
<a name="l00675"></a>00675     av_register_all();
<a name="l00676"></a>00676     av_alloc_format_context();
<a name="l00677"></a>00677 
<a name="l00678"></a>00678     <span class="comment">// inicializace spravneho dekoderu</span>
<a name="l00679"></a>00679     <span class="keywordflow">if</span>(strlen(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#5754365db059e54caaaea5020cc821d2">pipeName</a>) &gt; 0)
<a name="l00680"></a>00680     {
<a name="l00681"></a>00681         <a class="code" href="classCPipeDecoder.html">CPipeDecoder</a> *pd = <span class="keyword">new</span> <a class="code" href="classCPipeDecoder.html">CPipeDecoder</a>();
<a name="l00682"></a>00682         <span class="keywordflow">if</span>(!pd-&gt;<a class="code" href="classCPipeDecoder.html#5fd4e56ef1aeaf4f4eca38cf5fa33d09">OpenPipe</a>(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#5754365db059e54caaaea5020cc821d2">pipeName</a>))
<a name="l00683"></a>00683         {
<a name="l00684"></a>00684             cerr &lt;&lt; <span class="stringliteral">"Chyba otevirani pipe"</span> &lt;&lt; endl;
<a name="l00685"></a>00685             <span class="keywordflow">return</span> -1;
<a name="l00686"></a>00686         }
<a name="l00687"></a>00687         decoder = pd;
<a name="l00688"></a>00688     }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strlen(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#3f00b76063285cd0d1bd50a86dbeb92f">fileName</a>) &gt; 0)
<a name="l00689"></a>00689     {
<a name="l00690"></a>00690         <a class="code" href="classCVideoDecoder.html">CVideoDecoder</a> *vd = <span class="keyword">new</span> <a class="code" href="classCVideoDecoder.html">CVideoDecoder</a>();
<a name="l00691"></a>00691         <span class="keywordflow">if</span>(!vd-&gt;<a class="code" href="classCVideoDecoder.html#e1de3d15847f01a145d59a152f08e8f7">OpenFile</a>(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#3f00b76063285cd0d1bd50a86dbeb92f">fileName</a>))
<a name="l00692"></a>00692         {
<a name="l00693"></a>00693             cerr &lt;&lt; <span class="stringliteral">"Chyba otevirani souboru"</span> &lt;&lt; endl;
<a name="l00694"></a>00694             <span class="keywordflow">return</span> -1;
<a name="l00695"></a>00695         }
<a name="l00696"></a>00696         decoder = vd;
<a name="l00697"></a>00697     }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c114dc35d6ea615cc0f06cb664fe302a">fwNode</a> &gt; 0)
<a name="l00698"></a>00698     {
<a name="l00699"></a>00699         <a class="code" href="classCVideoCapturer.html">CVideoCapturer</a> *vc = <span class="keyword">new</span> <a class="code" href="classCVideoCapturer.html">CVideoCapturer</a>();
<a name="l00700"></a>00700         <span class="keywordflow">if</span>(!vc-&gt;<a class="code" href="classCVideoCapturer.html#65ec68077cfa9a997e45276d7c14a73f">StartCapture</a>(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c114dc35d6ea615cc0f06cb664fe302a">fwNode</a>-1))
<a name="l00701"></a>00701         {
<a name="l00702"></a>00702             cerr &lt;&lt; <span class="stringliteral">"Chyba inicializace iec61883"</span> &lt;&lt; endl;
<a name="l00703"></a>00703             <span class="keywordflow">return</span> -1;
<a name="l00704"></a>00704         }
<a name="l00705"></a>00705         decoder = vc;
<a name="l00706"></a>00706     }<span class="keywordflow">else</span>
<a name="l00707"></a>00707     {
<a name="l00708"></a>00708         cerr &lt;&lt; <span class="stringliteral">"Musite zadat zdroj videa"</span> &lt;&lt; endl;
<a name="l00709"></a>00709         <span class="keywordflow">return</span> -1;
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712     <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a> = decoder-&gt;<a class="code" href="classCDecoder.html#263a9f0f0a7dce5e2bfc729c6f3048f8">Width</a>();
<a name="l00713"></a>00713     <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a> = decoder-&gt;<a class="code" href="classCDecoder.html#ffde830607bd079473c831f5ae30d071">Height</a>();
<a name="l00714"></a>00714     <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c078fecdc60ecdadfe6120a72234ebf2">dump</a>)
<a name="l00715"></a>00715     {
<a name="l00716"></a>00716         decoder-&gt;<a class="code" href="classCDecoder.html#5fba8208be5c97868e022ffeddc3f6eb">DumpFormat</a>();
<a name="l00717"></a>00717         <span class="keywordflow">if</span>(encoder) encoder-&gt;<a class="code" href="classCVideoEncoder.html#99f3f9bae138fea64f6eeb256520cab5">DumpFormat</a>();
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720     <span class="comment">// pokud byl predan konfiguracni soubor tak nacteni</span>
<a name="l00721"></a>00721     <span class="keywordflow">if</span>(strlen(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#f2562ebcc61f9196bfe9bde09743e0a8">configName</a>) &gt; 0)
<a name="l00722"></a>00722     {
<a name="l00723"></a>00723         ifstream f(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#f2562ebcc61f9196bfe9bde09743e0a8">configName</a>);
<a name="l00724"></a>00724         <span class="keywordflow">if</span>(!f.good())
<a name="l00725"></a>00725         {
<a name="l00726"></a>00726             cerr &lt;&lt; <span class="stringliteral">"Chyba otevirani konfiguracniho souboru"</span> &lt;&lt; endl;
<a name="l00727"></a>00727             <span class="keywordflow">return</span> -1;
<a name="l00728"></a>00728         }
<a name="l00729"></a>00729         <span class="keywordflow">if</span>(!<a class="code" href="main_8cpp.html#5505b05b61299ab36808018d0dd17547">read_config</a>(f))
<a name="l00730"></a>00730         {
<a name="l00731"></a>00731             f.close();
<a name="l00732"></a>00732             <span class="keywordflow">return</span> -1;
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734         f.close();
<a name="l00735"></a>00735     }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737     <span class="comment">// pokud byl nastaven vystup</span>
<a name="l00738"></a>00738     <span class="keywordflow">if</span>(strlen(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c927c84494708366ca26a7a3816c2301">outputName</a>) &gt; 0)
<a name="l00739"></a>00739     {
<a name="l00740"></a>00740         <span class="keywordtype">int</span> ow = <a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#33e331e45d37d0804408fa1c132ca88e">outputWidth</a>;
<a name="l00741"></a>00741         <span class="keywordtype">int</span> oh = <a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#865ff7e96699933398dbaaa0b67de836">outputHeight</a>;
<a name="l00742"></a>00742         <span class="keywordflow">if</span>(ow == 0 || oh == 0)
<a name="l00743"></a>00743         {
<a name="l00744"></a>00744             ow = <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>;
<a name="l00745"></a>00745             oh = <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>;
<a name="l00746"></a>00746         }
<a name="l00747"></a>00747         cout &lt;&lt; <span class="stringliteral">"Rozliseni vystupu: "</span> &lt;&lt; ow &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; oh &lt;&lt; endl;
<a name="l00748"></a>00748 
<a name="l00749"></a>00749         encoder = <span class="keyword">new</span> <a class="code" href="classCVideoEncoder.html">CVideoEncoder</a>();
<a name="l00750"></a>00750         <span class="keywordflow">if</span>(!encoder-&gt;<a class="code" href="classCVideoEncoder.html#73cc169df8dde30f39277295abf89f8c">Open</a>(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#c927c84494708366ca26a7a3816c2301">outputName</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, ow, oh))
<a name="l00751"></a>00751         {
<a name="l00752"></a>00752             cout &lt;&lt; <span class="stringliteral">"output error"</span> &lt;&lt; endl;
<a name="l00753"></a>00753             <span class="keywordflow">return</span> -1;
<a name="l00754"></a>00754         }
<a name="l00755"></a>00755     }
<a name="l00756"></a>00756 
<a name="l00757"></a>00757     <span class="comment">// nastaveni grafickeho rezimu</span>
<a name="l00758"></a>00758     set_color_depth(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>);
<a name="l00759"></a>00759     set_gfx_mode(<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#15184328111fdbb45b30d42d74e21df2">fullscreen</a> ? GFX_AUTODETECT_FULLSCREEN : GFX_AUTODETECT_WINDOWED,
<a name="l00760"></a>00760         (<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#bdb92beff90cfeeddac3feb7a1a74d64">width</a> &gt; 0 ? <a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#bdb92beff90cfeeddac3feb7a1a74d64">width</a> : <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>),
<a name="l00761"></a>00761         (<a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#639b62946ad9df187f74c2bbaea94058">height</a> &gt; 0 ? <a class="code" href="main_8cpp.html#fbbc2059baa687a0c32830faf928d096">options</a>.<a class="code" href="structOptions__t.html#639b62946ad9df187f74c2bbaea94058">height</a> : <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>),
<a name="l00762"></a>00762         0,
<a name="l00763"></a>00763         0);
<a name="l00764"></a>00764     clear_keybuf();
<a name="l00765"></a>00765 
<a name="l00766"></a>00766     <span class="comment">// inicializace pomocnych bitmap</span>
<a name="l00767"></a>00767     bbuffer = create_bitmap_ex(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, SCREEN_W, SCREEN_H);
<a name="l00768"></a>00768     <span class="keywordflow">if</span>(bbuffer == NULL)
<a name="l00769"></a>00769     {
<a name="l00770"></a>00770         cerr &lt;&lt; <span class="stringliteral">"Chyba pri vytvareni video bitmapy"</span> &lt;&lt; endl;
<a name="l00771"></a>00771         <span class="keywordflow">return</span> -1;
<a name="l00772"></a>00772     }
<a name="l00773"></a>00773     frame = create_bitmap_ex(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>);
<a name="l00774"></a>00774     orig = create_bitmap_ex(<a class="code" href="main_8cpp.html#00731ab471a2b38632427d0d80a82278" title="barevna hloubka">bpp</a>, <a class="code" href="main_8cpp.html#3b322cc788cf1b95fc0c242cb102225b">ORIG_WIDTH</a>, <a class="code" href="main_8cpp.html#3011f7116dcb3bb5dcb483cc31c1383c">ORIG_HEIGHT</a>);
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="comment">// hlavni smycka</span>
<a name="l00777"></a>00777     <span class="keywordflow">while</span>(decoder-&gt;<a class="code" href="classCDecoder.html#0540cbb472f10c415002ff4290cc0bc1">GetNextFrame</a>(frame) &amp;&amp; !<a class="code" href="main_8cpp.html#752b7698937b6a908ce52deabebfc077" title="ukoncit aplikaci">end_app</a>)
<a name="l00778"></a>00778     {
<a name="l00779"></a>00779         <span class="comment">// nacteni vstupu</span>
<a name="l00780"></a>00780         memset(key_pressed, 0, KEY_MAX);
<a name="l00781"></a>00781         <span class="keywordflow">while</span>(keypressed()) key_pressed[(readkey() &gt;&gt; 8)] = <span class="keyword">true</span>;
<a name="l00782"></a>00782 
<a name="l00783"></a>00783         <span class="comment">// zkopirovani originalniho snimku do nahledu</span>
<a name="l00784"></a>00784         <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d" title="zobrazovat nastaveni">show_options</a>) stretch_blit(frame, orig, 0, 0, frame-&gt;w, frame-&gt;h, 0, 0, orig-&gt;w, orig-&gt;h);
<a name="l00785"></a>00785 
<a name="l00786"></a>00786         <span class="comment">// zpracovani sekvenci</span>
<a name="l00787"></a>00787         <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#5bc28e363ce09640d06d11264b58a42a" title="obsahuje sekvence">contain_sequences</a>) <a class="code" href="main_8cpp.html#a4609ae8e788af0627181bbb17a8aaf6">handle_sequences</a>(key_pressed);
<a name="l00788"></a>00788 
<a name="l00789"></a>00789         <span class="comment">// aplikace filtru</span>
<a name="l00790"></a>00790         <span class="keywordflow">for</span>(FilterVector_t::const_iterator it=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.begin();it!=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.end();it++)
<a name="l00791"></a>00791             (*it)-&gt;Apply(frame);
<a name="l00792"></a>00792 
<a name="l00793"></a>00793         <span class="comment">// zobrazeni upraveneho snimku</span>
<a name="l00794"></a>00794         <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a> == SCREEN_W &amp;&amp; <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a> == SCREEN_H)
<a name="l00795"></a>00795             blit(frame, bbuffer, 0, 0, 0, 0, SCREEN_W, SCREEN_H);
<a name="l00796"></a>00796         <span class="keywordflow">else</span>
<a name="l00797"></a>00797             stretch_blit(frame, bbuffer, 0, 0, <a class="code" href="main_8cpp.html#aa98c83ff1e06e1d8dcf0b187fb84162" title="sirka okna">video_width</a>, <a class="code" href="main_8cpp.html#5d644c450a7d4850db9b21131886a4b0" title="vyska okna">video_height</a>, 0, 0, SCREEN_W, SCREEN_H);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799         <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#5bc28e363ce09640d06d11264b58a42a" title="obsahuje sekvence">contain_sequences</a> &amp;&amp; <a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d" title="zobrazovat nastaveni">show_options</a>)
<a name="l00800"></a>00800         {   <span class="comment">// u sekvenci zobrazeni napovedy</span>
<a name="l00801"></a>00801             <a class="code" href="main_8cpp.html#2b7dd8985d42eb12eae2ddb30341de1e">render_sequences</a>(bbuffer);
<a name="l00802"></a>00802         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="main_8cpp.html#f124e7f74d731b97b870f21cafdc163d" title="zobrazovat nastaveni">show_options</a>)
<a name="l00803"></a>00803         {   <span class="comment">// vykresleni nahledu s nastavenim filtru</span>
<a name="l00804"></a>00804             blit(orig, bbuffer, 0, 0, SCREEN_W-orig-&gt;w-20, SCREEN_H-orig-&gt;h-20, SCREEN_W-20, SCREEN_H-20);
<a name="l00805"></a>00805             rect(bbuffer, SCREEN_W-orig-&gt;w-21, SCREEN_H-orig-&gt;h-21, SCREEN_W-19, SCREEN_H-19, makecol(255, 0, 0));
<a name="l00806"></a>00806             <a class="code" href="main_8cpp.html#40b3e73ea16926300f2b43367eeaf1be">render_options</a>(bbuffer);
<a name="l00807"></a>00807             <a class="code" href="main_8cpp.html#ba67695c0ab81949cad2f1a1bdae4657">render_help</a>(bbuffer);
<a name="l00808"></a>00808         }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810         <span class="comment">// zpracovani vstupu</span>
<a name="l00811"></a>00811         <a class="code" href="main_8cpp.html#cdb75405f5a62767b0b64ac07dc1936d">handle_input</a>(key_pressed);
<a name="l00812"></a>00812 
<a name="l00813"></a>00813         <span class="comment">//show_video_bitmap(bbuffer);</span>
<a name="l00814"></a>00814         blit(bbuffer, screen, 0, 0, 0, 0, SCREEN_W, SCREEN_H);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816         <span class="keywordflow">if</span>(encoder) encoder-&gt;<a class="code" href="classCVideoEncoder.html#b2d5c63976b112e799c73b3948848482">EncodeFrame</a>(frame);
<a name="l00817"></a>00817     }
<a name="l00818"></a>00818     <span class="keywordflow">if</span>(encoder)
<a name="l00819"></a>00819     {
<a name="l00820"></a>00820         encoder-&gt;<a class="code" href="classCVideoEncoder.html#5fcb4e5b677b9795d539d4e67d49a073">Close</a>();
<a name="l00821"></a>00821         <span class="keyword">delete</span> encoder;
<a name="l00822"></a>00822     }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     <span class="comment">// uvolneni dekoderu</span>
<a name="l00825"></a>00825     <span class="keyword">delete</span> decoder;
<a name="l00826"></a>00826 
<a name="l00827"></a>00827     <span class="comment">// uvolneni filtru</span>
<a name="l00828"></a>00828     <span class="keywordflow">for</span>(FilterVector_t::const_iterator it=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.begin();it!=<a class="code" href="main_8cpp.html#c15b93b53542c3b9ba3636bd2dcfa1ce" title="vektor filtru">filters</a>.end();it++)
<a name="l00829"></a>00829         <span class="keyword">delete</span> *it;
<a name="l00830"></a>00830 
<a name="l00831"></a>00831     <span class="comment">// uvolneni bitmap</span>
<a name="l00832"></a>00832     destroy_bitmap(orig);
<a name="l00833"></a>00833     destroy_bitmap(bbuffer);
<a name="l00834"></a>00834     <span class="comment">//destroy_bitmap(frame);</span>
<a name="l00835"></a>00835 
<a name="l00836"></a>00836     <span class="keywordflow">return</span> 0;
<a name="l00837"></a>00837 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Jan 25 21:54:54 2009 for RTVideoFilter by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
